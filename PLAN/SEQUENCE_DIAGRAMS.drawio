<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="Claude Code" etag="complete-app-sequence" version="22.1.16" type="device">
  <diagram id="complete-sequence-diagrams" name="Complete App Sequence Diagrams">
    <mxGraphModel dx="1422" dy="2000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- 1. OAuth認証フロー -->
        <mxCell id="oauth-title" value="1. OAuth認証フロー" style="text;html=1;strokeColor=none;fillColor=#e1d5e7;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="50" y="20" width="400" height="40" as="geometry" />
        </mxCell>
        
        <!-- OAuth Actors -->
        <mxCell id="oauth-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="80" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="oauth-frontend" value="フロントエンド&lt;br&gt;(Next.js)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="170" y="90" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oauth-api" value="API&lt;br&gt;(FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="320" y="90" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oauth-provider" value="OAuth&lt;br&gt;Provider" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="90" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oauth-db" value="データベース&lt;br&gt;(MySQL)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="620" y="90" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- OAuth Lifelines -->
        <mxCell id="oauth-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="75" y="140" as="sourcePoint" />
            <mxPoint x="75" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="140" as="sourcePoint" />
            <mxPoint x="220" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="140" as="sourcePoint" />
            <mxPoint x="370" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-provider-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="140" as="sourcePoint" />
            <mxPoint x="520" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-db-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="670" y="140" as="sourcePoint" />
            <mxPoint x="670" y="380" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- OAuth Messages -->
        <mxCell id="oauth-msg1" value="1. ログインボタン押下" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="155" as="sourcePoint" />
            <mxPoint x="215" y="155" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg2" value="2. OAuth認証リクエスト" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="170" as="sourcePoint" />
            <mxPoint x="515" y="170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg3" value="3. 認証画面表示" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="185" as="sourcePoint" />
            <mxPoint x="80" y="185" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg4" value="4. 認証情報入力" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="200" as="sourcePoint" />
            <mxPoint x="515" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg5" value="5. 認証コード返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="215" as="sourcePoint" />
            <mxPoint x="225" y="215" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg6" value="6. 認証コード送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="230" as="sourcePoint" />
            <mxPoint x="365" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg7" value="7. アクセストークン要求" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="245" as="sourcePoint" />
            <mxPoint x="515" y="245" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg8" value="8. アクセストークン返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="260" as="sourcePoint" />
            <mxPoint x="375" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg9" value="9. ユーザー情報取得" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="275" as="sourcePoint" />
            <mxPoint x="515" y="275" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg10" value="10. ユーザー情報返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="290" as="sourcePoint" />
            <mxPoint x="375" y="290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg11" value="11. ユーザー情報保存/更新" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="305" as="sourcePoint" />
            <mxPoint x="665" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg12" value="12. 保存完了" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="665" y="320" as="sourcePoint" />
            <mxPoint x="375" y="320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg13" value="13. JWTトークン発行" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="335" as="sourcePoint" />
            <mxPoint x="225" y="335" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oauth-msg14" value="14. ログイン完了・ダッシュボード表示" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="215" y="350" as="sourcePoint" />
            <mxPoint x="80" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 2. パーソナルカウンセラー機能 -->
        <mxCell id="counselor-title" value="2. パーソナルカウンセラー機能（AI API呼び出し）" style="text;html=1;strokeColor=none;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="50" y="420" width="500" height="40" as="geometry" />
        </mxCell>
        
        <!-- Counselor Actors -->
        <mxCell id="counselor-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="480" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="counselor-frontend" value="フロントエンド" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="170" y="490" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="counselor-api" value="API&lt;br&gt;(FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="320" y="490" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="counselor-openai" value="OpenAI API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="490" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="counselor-db" value="データベース" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="620" y="490" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Counselor Lifelines -->
        <mxCell id="counselor-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="75" y="540" as="sourcePoint" />
            <mxPoint x="75" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="540" as="sourcePoint" />
            <mxPoint x="220" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="540" as="sourcePoint" />
            <mxPoint x="370" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-openai-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="540" as="sourcePoint" />
            <mxPoint x="520" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-db-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="670" y="540" as="sourcePoint" />
            <mxPoint x="670" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Counselor Messages -->
        <mxCell id="counselor-msg1" value="1. 相談内容入力" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="555" as="sourcePoint" />
            <mxPoint x="215" y="555" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg2" value="2. カウンセリングリクエスト送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="570" as="sourcePoint" />
            <mxPoint x="365" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg3" value="3. 過去のカウンセリング履歴取得" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="585" as="sourcePoint" />
            <mxPoint x="665" y="585" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg4" value="4. 履歴データ返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="665" y="600" as="sourcePoint" />
            <mxPoint x="375" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg5" value="5. カウンセラー専用プロンプト構築" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="615" as="sourcePoint" />
            <mxPoint x="375" y="635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-note" value="カウンセラー人格 + 過去の相談内容 + 現在の悩み" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="430" y="605" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="counselor-msg6" value="6. GPT API呼び出し（カウンセリングモード）" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="655" as="sourcePoint" />
            <mxPoint x="515" y="655" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg7" value="7. 共感的・支援的な応答返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="670" as="sourcePoint" />
            <mxPoint x="375" y="670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg8" value="8. AI応答送信（セッション継続中は保存せず）" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="685" as="sourcePoint" />
            <mxPoint x="225" y="685" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="counselor-msg9" value="9. カウンセラー応答表示" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="215" y="700" as="sourcePoint" />
            <mxPoint x="80" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 3. 会話練習機能 -->
        <mxCell id="practice-title" value="3. 会話練習機能（AI API呼び出し）" style="text;html=1;strokeColor=none;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="50" y="760" width="450" height="40" as="geometry" />
        </mxCell>
        
        <!-- Practice Actors -->
        <mxCell id="practice-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="820" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="practice-frontend" value="フロントエンド" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="170" y="830" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="practice-api" value="API&lt;br&gt;(FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="320" y="830" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="practice-openai" value="OpenAI API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="830" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="practice-db" value="データベース" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="620" y="830" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Practice Lifelines -->
        <mxCell id="practice-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="75" y="880" as="sourcePoint" />
            <mxPoint x="75" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="880" as="sourcePoint" />
            <mxPoint x="220" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="880" as="sourcePoint" />
            <mxPoint x="370" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-openai-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="880" as="sourcePoint" />
            <mxPoint x="520" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-db-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="670" y="880" as="sourcePoint" />
            <mxPoint x="670" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Practice Messages -->
        <mxCell id="practice-msg1" value="1. 練習発言入力" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="895" as="sourcePoint" />
            <mxPoint x="215" y="895" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg2" value="2. 会話練習リクエスト送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="910" as="sourcePoint" />
            <mxPoint x="365" y="910" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg3" value="3. 練習履歴・レベル取得" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="925" as="sourcePoint" />
            <mxPoint x="665" y="925" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg4" value="4. ユーザーデータ返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="665" y="940" as="sourcePoint" />
            <mxPoint x="375" y="940" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg5" value="5. 会話練習専用プロンプト構築" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="955" as="sourcePoint" />
            <mxPoint x="375" y="975" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-note" value="練習相手キャラクター + 現在の会話流れ + 評価基準" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="430" y="945" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="practice-msg6" value="6. GPT API呼び出し（練習モード）" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="995" as="sourcePoint" />
            <mxPoint x="515" y="995" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg7" value="7. 相手応答 + リアルタイム評価返却" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="1010" as="sourcePoint" />
            <mxPoint x="375" y="1010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg8" value="8. AI応答 + 評価スコア送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="1025" as="sourcePoint" />
            <mxPoint x="225" y="1025" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="practice-msg9" value="9. 相手応答 + 改善ポイント表示" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="215" y="1040" as="sourcePoint" />
            <mxPoint x="80" y="1040" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 4. 音声処理フロー -->
        <mxCell id="voice-title" value="4. 音声処理フロー（仮実装）" style="text;html=1;strokeColor=none;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="50" y="1100" width="400" height="40" as="geometry" />
        </mxCell>
        
        <!-- Voice Actors -->
        <mxCell id="voice-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="50" y="1160" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="voice-frontend" value="フロントエンド" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="130" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="voice-api" value="API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="250" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="voice-stt" value="Speech-to-Text" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="370" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="voice-openai" value="OpenAI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="490" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="voice-tts" value="Text-to-Speech" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="610" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="voice-db" value="DB" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="730" y="1170" width="80" height="40" as="geometry" />
        </mxCell>
        
        <!-- Voice Lifelines -->
        <mxCell id="voice-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="65" y="1220" as="sourcePoint" />
            <mxPoint x="65" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="170" y="1220" as="sourcePoint" />
            <mxPoint x="170" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="290" y="1220" as="sourcePoint" />
            <mxPoint x="290" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-stt-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="410" y="1220" as="sourcePoint" />
            <mxPoint x="410" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-openai-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="530" y="1220" as="sourcePoint" />
            <mxPoint x="530" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-tts-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="650" y="1220" as="sourcePoint" />
            <mxPoint x="650" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-db-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="770" y="1220" as="sourcePoint" />
            <mxPoint x="770" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Voice Messages -->
        <mxCell id="voice-msg1" value="1. 音声録音開始" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="1235" as="sourcePoint" />
            <mxPoint x="165" y="1235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg2" value="2. 音声録音終了" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="1250" as="sourcePoint" />
            <mxPoint x="165" y="1250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg3" value="3. 音声ファイル送信" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="175" y="1265" as="sourcePoint" />
            <mxPoint x="285" y="1265" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg4" value="4. 音声→テキスト変換" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="295" y="1280" as="sourcePoint" />
            <mxPoint x="405" y="1280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg5" value="5. テキスト返却" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="405" y="1295" as="sourcePoint" />
            <mxPoint x="295" y="1295" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg6" value="6. 音声テキスト保存" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="295" y="1310" as="sourcePoint" />
            <mxPoint x="765" y="1310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg7" value="7. テキストでAI処理" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="295" y="1325" as="sourcePoint" />
            <mxPoint x="525" y="1325" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg8" value="8. AI応答テキスト" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="525" y="1340" as="sourcePoint" />
            <mxPoint x="295" y="1340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg9" value="9. テキスト→音声変換" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="295" y="1355" as="sourcePoint" />
            <mxPoint x="645" y="1355" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg10" value="10. 音声ファイル返却" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="645" y="1370" as="sourcePoint" />
            <mxPoint x="295" y="1370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg11" value="11. 応答履歴保存" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="295" y="1385" as="sourcePoint" />
            <mxPoint x="765" y="1385" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg12" value="12. AI音声応答送信" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="285" y="1400" as="sourcePoint" />
            <mxPoint x="175" y="1400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="voice-msg13" value="13. 音声再生" style="endArrow=classic;html=1;fontSize=10;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="165" y="1415" as="sourcePoint" />
            <mxPoint x="70" y="1415" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- 5. データ保存（キャッシュ経由） -->
        <mxCell id="cache-title" value="5. データ保存（セッション終了時・キャッシュ経由パターン）" style="text;html=1;strokeColor=none;fillColor=#ffe6cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="50" y="1490" width="600" height="40" as="geometry" />
        </mxCell>
        
        <!-- Cache Actors -->
        <mxCell id="cache-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="1550" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="cache-frontend" value="フロントエンド" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="170" y="1560" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cache-api" value="API&lt;br&gt;(FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="320" y="1560" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cache-redis" value="Redis&lt;br&gt;(キャッシュ)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="1560" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cache-mysql" value="MySQL&lt;br&gt;(データベース)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="620" y="1560" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Cache Lifelines -->
        <mxCell id="cache-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="75" y="1610" as="sourcePoint" />
            <mxPoint x="75" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="1610" as="sourcePoint" />
            <mxPoint x="220" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="1610" as="sourcePoint" />
            <mxPoint x="370" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-redis-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="1610" as="sourcePoint" />
            <mxPoint x="520" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-mysql-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="670" y="1610" as="sourcePoint" />
            <mxPoint x="670" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Cache Session Note -->
        <mxCell id="cache-session-note" value="セッション中は一時保存のみ" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="750" y="1630" width="150" height="40" as="geometry" />
        </mxCell>
        
        <!-- Cache Loop Box -->
        <mxCell id="cache-loop-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;dashed=1;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="50" y="1650" width="650" height="120" as="geometry" />
        </mxCell>
        <mxCell id="cache-loop-label" value="セッション中の操作（ループ）" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="55" y="1655" width="150" height="20" as="geometry" />
        </mxCell>
        
        <!-- Cache Session Messages -->
        <mxCell id="cache-session-msg1" value="ユーザー入力・操作" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="1680" as="sourcePoint" />
            <mxPoint x="215" y="1680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-session-msg2" value="データ送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="1700" as="sourcePoint" />
            <mxPoint x="365" y="1700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-session-msg3" value="セッションデータをキャッシュに蓄積" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="1720" as="sourcePoint" />
            <mxPoint x="515" y="1720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-session-msg4" value="キャッシュ保存確認" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="1740" as="sourcePoint" />
            <mxPoint x="375" y="1740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-session-msg5" value="即座にレスポンス" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="1760" as="sourcePoint" />
            <mxPoint x="225" y="1760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Cache End Session -->
        <mxCell id="cache-end-note" value="セッション終了時に一括保存" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="750" y="1790" width="150" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="cache-end-msg1" value="セッション終了操作" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="1795" as="sourcePoint" />
            <mxPoint x="215" y="1795" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-end-msg2" value="セッション終了リクエスト" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="1810" as="sourcePoint" />
            <mxPoint x="365" y="1810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-end-msg3" value="セッションデータ全体取得" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="1825" as="sourcePoint" />
            <mxPoint x="515" y="1825" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-end-msg4" value="データ整合性チェック・整形" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="1840" as="sourcePoint" />
            <mxPoint x="375" y="1860" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-end-msg5" value="セッションデータ一括保存" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="1880" as="sourcePoint" />
            <mxPoint x="665" y="1880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cache-end-msg6" value="保存完了・キャッシュクリア" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="1900" as="sourcePoint" />
            <mxPoint x="225" y="1900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Benefits Note -->
        <mxCell id="cache-benefits" value="メリット：高速レスポンス・DB負荷軽減&lt;br&gt;デメリット：キャッシュ障害時データ損失リスク" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="750" y="1850" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- 6. エラーハンドリング -->
        <mxCell id="error-title" value="6. エラーハンドリング" style="text;html=1;strokeColor=none;fillColor=#ffcccc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1;strokeColor=#ff6666;" vertex="1" parent="1">
          <mxGeometry x="50" y="1940" width="300" height="40" as="geometry" />
        </mxCell>
        
        <!-- Error Actors -->
        <mxCell id="error-user" value="ユーザー" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="2000" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="error-frontend" value="フロントエンド" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="170" y="2010" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="error-api" value="API&lt;br&gt;(FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="320" y="2010" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="error-openai" value="OpenAI API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="470" y="2010" width="100" height="40" as="geometry" />
        </mxCell>
        
        <!-- Error Lifelines -->
        <mxCell id="error-user-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="75" y="2060" as="sourcePoint" />
            <mxPoint x="75" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-frontend-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="220" y="2060" as="sourcePoint" />
            <mxPoint x="220" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-api-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="2060" as="sourcePoint" />
            <mxPoint x="370" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-openai-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="2060" as="sourcePoint" />
            <mxPoint x="520" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Error Messages -->
        <mxCell id="error-msg1" value="1. リクエスト送信" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="2075" as="sourcePoint" />
            <mxPoint x="215" y="2075" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg2" value="2. API呼び出し" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="2090" as="sourcePoint" />
            <mxPoint x="365" y="2090" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg3" value="3. AI API呼び出し" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="2105" as="sourcePoint" />
            <mxPoint x="515" y="2105" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg4" value="4. APIエラー(タイムアウト/レート制限)" style="endArrow=none;html=1;fontSize=11;strokeColor=#ff0000;endFill=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="515" y="2120" as="sourcePoint" />
            <mxPoint x="375" y="2120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-cross" value="X" style="text;html=1;strokeColor=#ff0000;fillColor=#ff0000;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="440" y="2110" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="error-msg5" value="5. エラーログ記録" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="375" y="2140" as="sourcePoint" />
            <mxPoint x="375" y="2160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg6" value="6. エラーレスポンス" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="2180" as="sourcePoint" />
            <mxPoint x="225" y="2180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg7" value="7. エラーメッセージ表示" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="215" y="2200" as="sourcePoint" />
            <mxPoint x="80" y="2200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg8" value="8. 再試行ボタン押下" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="2220" as="sourcePoint" />
            <mxPoint x="215" y="2220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg9" value="9. リトライ処理" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="225" y="2240" as="sourcePoint" />
            <mxPoint x="365" y="2240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="error-msg10" value="10. 成功時は正常応答 / 失敗時は管理者連絡案内" style="endArrow=classic;html=1;fontSize=11;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="365" y="2260" as="sourcePoint" />
            <mxPoint x="225" y="2260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="error-note" value="通信環境のエラーでただいま使用できません。&lt;br&gt;しばらく待ってから再度お試しください。" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffcccc;strokeColor=#ff6666;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="600" y="2180" width="200" height="60" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>